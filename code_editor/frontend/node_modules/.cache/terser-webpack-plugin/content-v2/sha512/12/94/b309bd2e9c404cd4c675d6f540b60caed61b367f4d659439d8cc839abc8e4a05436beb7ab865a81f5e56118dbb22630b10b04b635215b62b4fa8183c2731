{"code":"ace.define(\"ace/ext/elastic_tabstops_lite\",[\"require\",\"exports\",\"module\",\"ace/editor\",\"ace/config\"],(function(t,e,o){\"use strict\";var s=function(){function t(t){this.$editor=t;var e=this,o=[],s=!1;this.onAfterExec=function(){s=!1,e.processRows(o),o=[]},this.onExec=function(){s=!0},this.onChange=function(t){s&&(-1==o.indexOf(t.start.row)&&o.push(t.start.row),t.end.row!=t.start.row&&o.push(t.end.row))}}return t.prototype.processRows=function(t){this.$inChange=!0;for(var e=[],o=0,s=t.length;o<s;o++){var i=t[o];if(!(e.indexOf(i)>-1))for(var n=this.$findCellWidthsForBlock(i),r=this.$setBlockCellWidthsToMax(n.cellWidths),a=n.firstRow,h=0,c=r.length;h<c;h++){var l=r[h];e.push(a),this.$adjustRow(a,l),a++}}this.$inChange=!1},t.prototype.$findCellWidthsForBlock=function(t){for(var e,o=[],s=t;s>=0&&0!=(e=this.$cellWidthsForRow(s)).length;)o.unshift(e),s--;var i=s+1;s=t;for(var n=this.$editor.session.getLength();s<n-1&&(s++,0!=(e=this.$cellWidthsForRow(s)).length);)o.push(e);return{cellWidths:o,firstRow:i}},t.prototype.$cellWidthsForRow=function(t){for(var e=this.$selectionColumnsForRow(t),o=[-1].concat(this.$tabsForRow(t)),s=o.map((function(t){return 0})).slice(1),i=this.$editor.session.getLine(t),n=0,r=o.length-1;n<r;n++){var a=o[n]+1,h=o[n+1],c=this.$rightmostSelectionInCell(e,h),l=i.substring(a,h);s[n]=Math.max(l.replace(/\\s+$/g,\"\").length,c-a)}return s},t.prototype.$selectionColumnsForRow=function(t){var e=[],o=this.$editor.getCursorPosition();return this.$editor.session.getSelection().isEmpty()&&t==o.row&&e.push(o.column),e},t.prototype.$setBlockCellWidthsToMax=function(t){for(var e,o,s,i=!0,n=this.$izip_longest(t),r=0,a=n.length;r<a;r++){var h=n[r];if(h.push){h.push(NaN);for(var c=0,l=h.length;c<l;c++){var p=h[c];if(i&&(e=c,s=0,i=!1),isNaN(p)){o=c;for(var u=e;u<o;u++)t[u][r]=s;i=!0}s=Math.max(s,p)}}else console.error(h)}return t},t.prototype.$rightmostSelectionInCell=function(t,e){var o=0;if(t.length){for(var s=[],i=0,n=t.length;i<n;i++)t[i]<=e?s.push(i):s.push(0);o=Math.max.apply(Math,s)}return o},t.prototype.$tabsForRow=function(t){for(var e,o=[],s=this.$editor.session.getLine(t),i=/\\t/g;null!=(e=i.exec(s));)o.push(e.index);return o},t.prototype.$adjustRow=function(t,e){var o=this.$tabsForRow(t);if(0!=o.length)for(var s=0,i=-1,n=this.$izip(e,o),r=0,a=n.length;r<a;r++){var h=n[r][0],c=n[r][1],l=(i+=1+h)-(c+=s);if(0!=l){var p=this.$editor.session.getLine(t).substr(0,c),u=p.replace(/\\s*$/g,\"\"),f=p.length-u.length;l>0&&(this.$editor.session.getDocument().insertInLine({row:t,column:c+1},Array(l+1).join(\" \")+\"\\t\"),this.$editor.session.getDocument().removeInLine(t,c,c+1),s+=l),l<0&&f>=-l&&(this.$editor.session.getDocument().removeInLine(t,c+l,c),s+=l)}}},t.prototype.$izip_longest=function(t){if(!t[0])return[];for(var e=t[0].length,o=t.length,s=1;s<o;s++){var i=t[s].length;i>e&&(e=i)}for(var n=[],r=0;r<e;r++){var a=[];for(s=0;s<o;s++)\"\"===t[s][r]?a.push(NaN):a.push(t[s][r]);n.push(a)}return n},t.prototype.$izip=function(t,e){for(var o=t.length>=e.length?e.length:t.length,s=[],i=0;i<o;i++){var n=[t[i],e[i]];s.push(n)}return s},t}();e.ElasticTabstopsLite=s;var i=t(\"../editor\").Editor;t(\"../config\").defineOptions(i.prototype,\"editor\",{useElasticTabstops:{set:function(t){t?(this.elasticTabstops||(this.elasticTabstops=new s(this)),this.commands.on(\"afterExec\",this.elasticTabstops.onAfterExec),this.commands.on(\"exec\",this.elasticTabstops.onExec),this.on(\"change\",this.elasticTabstops.onChange)):this.elasticTabstops&&(this.commands.removeListener(\"afterExec\",this.elasticTabstops.onAfterExec),this.commands.removeListener(\"exec\",this.elasticTabstops.onExec),this.removeListener(\"change\",this.elasticTabstops.onChange))}}})})),ace.require([\"ace/ext/elastic_tabstops_lite\"],(function(t){\"object\"==typeof module&&\"object\"==typeof exports&&module&&(module.exports=t)}));","name":"ca1cded639d22f7581116c31ae006682.js","input":"ace.define(\"ace/ext/elastic_tabstops_lite\", [\"require\", \"exports\", \"module\", \"ace/editor\", \"ace/config\"], function (require, exports, module) {\n  \"use strict\";\n\n  var ElasticTabstopsLite = /** @class */function () {\n    function ElasticTabstopsLite(editor) {\n      this.$editor = editor;\n      var self = this;\n      var changedRows = [];\n      var recordChanges = false;\n      this.onAfterExec = function () {\n        recordChanges = false;\n        self.processRows(changedRows);\n        changedRows = [];\n      };\n      this.onExec = function () {\n        recordChanges = true;\n      };\n      this.onChange = function (delta) {\n        if (recordChanges) {\n          if (changedRows.indexOf(delta.start.row) == -1) changedRows.push(delta.start.row);\n          if (delta.end.row != delta.start.row) changedRows.push(delta.end.row);\n        }\n      };\n    }\n    ElasticTabstopsLite.prototype.processRows = function (rows) {\n      this.$inChange = true;\n      var checkedRows = [];\n      for (var r = 0, rowCount = rows.length; r < rowCount; r++) {\n        var row = rows[r];\n        if (checkedRows.indexOf(row) > -1) continue;\n        var cellWidthObj = this.$findCellWidthsForBlock(row);\n        var cellWidths = this.$setBlockCellWidthsToMax(cellWidthObj.cellWidths);\n        var rowIndex = cellWidthObj.firstRow;\n        for (var w = 0, l = cellWidths.length; w < l; w++) {\n          var widths = cellWidths[w];\n          checkedRows.push(rowIndex);\n          this.$adjustRow(rowIndex, widths);\n          rowIndex++;\n        }\n      }\n      this.$inChange = false;\n    };\n    ElasticTabstopsLite.prototype.$findCellWidthsForBlock = function (row) {\n      var cellWidths = [],\n        widths;\n      var rowIter = row;\n      while (rowIter >= 0) {\n        widths = this.$cellWidthsForRow(rowIter);\n        if (widths.length == 0) break;\n        cellWidths.unshift(widths);\n        rowIter--;\n      }\n      var firstRow = rowIter + 1;\n      rowIter = row;\n      var numRows = this.$editor.session.getLength();\n      while (rowIter < numRows - 1) {\n        rowIter++;\n        widths = this.$cellWidthsForRow(rowIter);\n        if (widths.length == 0) break;\n        cellWidths.push(widths);\n      }\n      return {\n        cellWidths: cellWidths,\n        firstRow: firstRow\n      };\n    };\n    ElasticTabstopsLite.prototype.$cellWidthsForRow = function (row) {\n      var selectionColumns = this.$selectionColumnsForRow(row);\n      var tabs = [-1].concat(this.$tabsForRow(row));\n      var widths = tabs.map(function (el) {\n        return 0;\n      }).slice(1);\n      var line = this.$editor.session.getLine(row);\n      for (var i = 0, len = tabs.length - 1; i < len; i++) {\n        var leftEdge = tabs[i] + 1;\n        var rightEdge = tabs[i + 1];\n        var rightmostSelection = this.$rightmostSelectionInCell(selectionColumns, rightEdge);\n        var cell = line.substring(leftEdge, rightEdge);\n        widths[i] = Math.max(cell.replace(/\\s+$/g, '').length, rightmostSelection - leftEdge);\n      }\n      return widths;\n    };\n    ElasticTabstopsLite.prototype.$selectionColumnsForRow = function (row) {\n      var selections = [],\n        cursor = this.$editor.getCursorPosition();\n      if (this.$editor.session.getSelection().isEmpty()) {\n        if (row == cursor.row) selections.push(cursor.column);\n      }\n      return selections;\n    };\n    ElasticTabstopsLite.prototype.$setBlockCellWidthsToMax = function (cellWidths) {\n      var startingNewBlock = true,\n        blockStartRow,\n        blockEndRow,\n        maxWidth;\n      var columnInfo = this.$izip_longest(cellWidths);\n      for (var c = 0, l = columnInfo.length; c < l; c++) {\n        var column = columnInfo[c];\n        if (!column.push) {\n          console.error(column);\n          continue;\n        }\n        column.push(NaN);\n        for (var r = 0, s = column.length; r < s; r++) {\n          var width = column[r];\n          if (startingNewBlock) {\n            blockStartRow = r;\n            maxWidth = 0;\n            startingNewBlock = false;\n          }\n          if (isNaN(width)) {\n            blockEndRow = r;\n            for (var j = blockStartRow; j < blockEndRow; j++) {\n              cellWidths[j][c] = maxWidth;\n            }\n            startingNewBlock = true;\n          }\n          maxWidth = Math.max(maxWidth, width);\n        }\n      }\n      return cellWidths;\n    };\n    ElasticTabstopsLite.prototype.$rightmostSelectionInCell = function (selectionColumns, cellRightEdge) {\n      var rightmost = 0;\n      if (selectionColumns.length) {\n        var lengths = [];\n        for (var s = 0, length = selectionColumns.length; s < length; s++) {\n          if (selectionColumns[s] <= cellRightEdge) lengths.push(s);else lengths.push(0);\n        }\n        rightmost = Math.max.apply(Math, lengths);\n      }\n      return rightmost;\n    };\n    ElasticTabstopsLite.prototype.$tabsForRow = function (row) {\n      var rowTabs = [],\n        line = this.$editor.session.getLine(row),\n        re = /\\t/g,\n        match;\n      while ((match = re.exec(line)) != null) {\n        rowTabs.push(match.index);\n      }\n      return rowTabs;\n    };\n    ElasticTabstopsLite.prototype.$adjustRow = function (row, widths) {\n      var rowTabs = this.$tabsForRow(row);\n      if (rowTabs.length == 0) return;\n      var bias = 0,\n        location = -1;\n      var expandedSet = this.$izip(widths, rowTabs);\n      for (var i = 0, l = expandedSet.length; i < l; i++) {\n        var w = expandedSet[i][0],\n          it = expandedSet[i][1];\n        location += 1 + w;\n        it += bias;\n        var difference = location - it;\n        if (difference == 0) continue;\n        var partialLine = this.$editor.session.getLine(row).substr(0, it);\n        var strippedPartialLine = partialLine.replace(/\\s*$/g, \"\");\n        var ispaces = partialLine.length - strippedPartialLine.length;\n        if (difference > 0) {\n          this.$editor.session.getDocument().insertInLine({\n            row: row,\n            column: it + 1\n          }, Array(difference + 1).join(\" \") + \"\\t\");\n          this.$editor.session.getDocument().removeInLine(row, it, it + 1);\n          bias += difference;\n        }\n        if (difference < 0 && ispaces >= -difference) {\n          this.$editor.session.getDocument().removeInLine(row, it + difference, it);\n          bias += difference;\n        }\n      }\n    };\n    ElasticTabstopsLite.prototype.$izip_longest = function (iterables) {\n      if (!iterables[0]) return [];\n      var longest = iterables[0].length;\n      var iterablesLength = iterables.length;\n      for (var i = 1; i < iterablesLength; i++) {\n        var iLength = iterables[i].length;\n        if (iLength > longest) longest = iLength;\n      }\n      var expandedSet = [];\n      for (var l = 0; l < longest; l++) {\n        var set = [];\n        for (var i = 0; i < iterablesLength; i++) {\n          if (iterables[i][l] === \"\") set.push(NaN);else set.push(iterables[i][l]);\n        }\n        expandedSet.push(set);\n      }\n      return expandedSet;\n    };\n    ElasticTabstopsLite.prototype.$izip = function (widths, tabs) {\n      var size = widths.length >= tabs.length ? tabs.length : widths.length;\n      var expandedSet = [];\n      for (var i = 0; i < size; i++) {\n        var set = [widths[i], tabs[i]];\n        expandedSet.push(set);\n      }\n      return expandedSet;\n    };\n    return ElasticTabstopsLite;\n  }();\n  exports.ElasticTabstopsLite = ElasticTabstopsLite;\n  var Editor = require(\"../editor\").Editor;\n  require(\"../config\").defineOptions(Editor.prototype, \"editor\", {\n    useElasticTabstops: {\n      set: function (val) {\n        if (val) {\n          if (!this.elasticTabstops) this.elasticTabstops = new ElasticTabstopsLite(this);\n          this.commands.on(\"afterExec\", this.elasticTabstops.onAfterExec);\n          this.commands.on(\"exec\", this.elasticTabstops.onExec);\n          this.on(\"change\", this.elasticTabstops.onChange);\n        } else if (this.elasticTabstops) {\n          this.commands.removeListener(\"afterExec\", this.elasticTabstops.onAfterExec);\n          this.commands.removeListener(\"exec\", this.elasticTabstops.onExec);\n          this.removeListener(\"change\", this.elasticTabstops.onChange);\n        }\n      }\n    }\n  });\n});\n(function () {\n  ace.require([\"ace/ext/elastic_tabstops_lite\"], function (m) {\n    if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n      module.exports = m;\n    }\n  });\n})();"}